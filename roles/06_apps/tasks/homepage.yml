---
- name: Check if Homepage is already installed
  kubernetes.core.k8s_info:
    api_version: apps/v1
    kind: Deployment
    name: homepage
    namespace: homepage
  register: Homepage_check
  ignore_errors: true
  when: deploy_homepage | bool

- name: Fetch Homepage Helm chart information
  kubernetes.core.helm_info:
    name: homepage
    release_namespace: homepage
  register: Homepage_helm_info
  ignore_errors: true
  when: deploy_homepage | bool

- name: Create Homepage icons ConfigMap
  kubernetes.core.k8s:
    state: present
    definition:
      apiVersion: v1
      kind: ConfigMap
      metadata:
        name: homepage-icons
        namespace: homepage
      data:
        "rancher.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="-0.1 135.7 512.07 240.6"><path d="m511.7 188.6-5.6-33.4c-1.8-10.7-6-19.5-9.2-19.5-3.4 0-6 9-6 19.7v8.7c0 10.7-9 19.7-19.7 19.7h-10.5v24h34.7c10.7.1 18.1-8.7 16.3-19.2m-78.6-28.2h-109c-.7 0-1.3 0-1.8.2v-5.2c0-10.7-2.7-19.7-6-19.7-3.4 0-7.4 8.7-9.2 19.5l-5.6 33.4c-1.8 10.7 5.6 19.5 16.6 19.5h32.7c3.4 0 6.5-.4 9.4-1.3-1.1 5.6-5.8 9.9-11.9 9.9h-45.9c-7.4 0-13-6.7-11.9-14.1l4.7-28c1.1-7.4-4.5-14.1-11.9-14.1H54.4c-4.9 0-9 2.9-11 7.2l-43 65.6c-.7 1.1-.7 2.5.2 3.6l8.3 9.9c1.1 1.3 2.9 1.3 4.3.4L42.6 224v140.2c0 6.7 5.4 12.1 12.1 12.1h64.9c6.7 0 12.1-5.4 12.1-12.1v-48.8c0-6.7 5.4-12.1 12.1-12.1h162.1c6.7 0 12.1 5.4 12.1 12.1v48.8c0 6.7 5.4 12.1 12.1 12.1H395c6.7 0 12.1-5.4 12.1-12.1v-52.4h-34.5c-10.7 0-19.7-9-19.7-19.7v-33.8c0-6.5 3.1-12.1 7.8-15.7v40.3c0 10.7 9 19.7 19.7 19.7h53.1c10.7 0 19.7-9 19.7-19.7V180.3c-.4-11.2-9.1-19.9-20.1-19.9" style="fill:#2453ff"/></svg>
        "argo.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="42.55 4.5 272.61 350.3"><defs><clipPath id="clip-path"><path d="m241.019 115.687-7.173 163.792H126.245l-5.978-163.792" style="fill:none"/></clipPath><style>.cls-2{fill:#e9654b}.cls-3{fill:#b6cfea}.cls-6{fill:#ee794b}.cls-12{fill:#010101}.cls-13{fill:#fff}</style></defs><path d="M123.854 251.982s-2.391 7.173-5.978 10.76a10.85 10.85 0 0 1-8.369 3.586 139 139 0 0 1-17.933 3.587s8.369 1.196 17.933 2.391c3.587 0 3.587 0 5.978 1.196 5.978 0 8.37-3.587 8.37-3.587Zm109.992 0s2.391 7.173 5.978 10.76a10.85 10.85 0 0 0 8.369 3.586 139 139 0 0 0 17.933 3.587s-8.369 1.196-19.129 2.391c-3.587 0-3.587 0-5.978 1.196-7.173 0-8.369-3.587-8.369-3.587Z" class="cls-2"/><circle cx="180.046" cy="133.621" r="129.121" class="cls-3"/><circle cx="180.046" cy="133.621" r="124.339" style="fill:#e6f5f8"/><circle cx="180.046" cy="136.012" r="101.623" style="fill:#d0e8f0"/><g id="Body"><path d="M120.267 183.834s8.37 135.1 8.37 137.49c0 1.196 1.195 3.587-4.783 5.978s-25.107 7.173-25.107 7.173h28.694c13.151 0 13.151-10.76 13.151-13.15s3.587-53.801 3.587-53.801 1.195 60.974 1.195 63.365-1.195 5.978-9.564 8.369l-23.912 4.782h27.498c16.738 0 16.738-10.76 16.738-10.76l3.587-53.8s1.196 53.8 1.196 59.778c0 4.782-3.587 8.369-16.738 10.76-8.37 2.39-19.13 4.782-19.13 4.782h31.085c15.543-1.195 17.934-11.956 17.934-11.956l26.302-133.903Z" class="cls-6"/><path d="M239.824 183.834s-8.37 135.1-8.37 137.49c0 1.196-1.195 3.587 4.783 5.978s25.107 7.173 25.107 7.173H232.65c-13.15 0-13.15-10.76-13.15-13.15s-3.588-53.801-3.588-53.801-1.195 60.974-1.195 63.365 1.195 5.978 9.564 8.369l23.912 4.782h-27.498c-16.738 0-16.738-10.76-16.738-10.76l-3.587-53.8s-1.195 53.8-1.195 59.778c0 4.782 3.586 8.369 16.737 10.76 8.37 2.39 19.13 4.782 19.13 4.782h-31.085c-15.543-1.195-17.934-11.956-17.934-11.956l-26.302-133.903Zm1.196-65.755c0 33.475-27.499 59.778-59.779 59.778s-59.778-27.498-59.778-59.778S148.961 58.3 181.241 58.3s59.778 26.303 59.778 59.779" class="cls-6"/><circle cx="181.241" cy="150.359" r="106.405" class="cls-6" style="clip-path:url(#clip-path)"/><g style="opacity:.22"><path d="M237.433 183.834s7.173-63.364-2.392-87.276C217.108 54.714 175.263 58.3 175.263 58.3s23.912 9.565 25.107 45.432c1.196 25.107 0 62.169 0 62.169Z" style="fill:#e34e3b"/></g></g><g id="Face"><g style="opacity:.5"><circle cx="156.134" cy="85.798" r="8.369" style="fill:#fbdfc3"/></g><path d="M201.566 207.746c0 20.324-9.565 33.475-21.52 33.475s-21.52-15.542-21.52-35.866c0 0 9.564 19.129 22.715 19.129s20.325-16.738 20.325-16.738" class="cls-12"/><path d="M201.566 207.746c0 13.15-9.565 20.324-21.52 20.324s-20.325-9.564-20.325-21.52c0 0 9.565 11.956 22.716 11.956s19.129-10.76 19.129-10.76" class="cls-13"/><circle cx="221.89" cy="151.554" r="37.062" class="cls-2"/><circle cx="138.201" cy="151.554" r="37.062" class="cls-2"/><circle cx="221.89" cy="151.554" r="28.694" class="cls-13"/><circle cx="135.81" cy="151.554" r="28.694" class="cls-13"/><circle cx="135.81" cy="147.968" r="8.369" class="cls-12"/><circle cx="221.89" cy="147.968" r="8.369" class="cls-12"/></g><path d="M48.534 165.901a5.648 5.648 0 0 1-5.978-5.978v-47.822a5.648 5.648 0 0 1 5.978-5.978 5.648 5.648 0 0 1 5.977 5.978v47.822a5.648 5.648 0 0 1-5.977 5.978m260.632 0a5.648 5.648 0 0 1-5.977-5.978v-47.822a5.648 5.648 0 0 1 5.977-5.978 5.648 5.648 0 0 1 5.978 5.978v47.822a5.648 5.648 0 0 1-5.978 5.978" class="cls-3"/><circle cx="139.396" cy="37.976" r="5.978" class="cls-13"/><path d="M96.356 199.377a4.4 4.4 0 0 1-3.587-1.196c-14.346-17.933-21.52-40.649-21.52-63.365a106.7 106.7 0 0 1 14.347-53.8 117 117 0 0 1 38.258-38.258 5.26 5.26 0 0 1 5.978 1.196 5.26 5.26 0 0 1-1.196 5.977 96.5 96.5 0 0 0-49.018 83.69 94.22 94.22 0 0 0 20.325 58.582c1.195 1.196 1.195 4.783-1.196 5.978-1.195 1.196-1.195 1.196-2.39 1.196" class="cls-13"/><path d="M233.846 255.568v-9.564c-16.738 9.564-34.671 19.129-56.192 19.129-23.91 0-39.453-10.76-54.995-19.13l1.195 9.565s17.934 19.13 54.996 19.13c34.671-1.196 54.996-19.13 54.996-19.13" class="cls-2" style="opacity:.25"/></svg>
        "authentik.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" id="Layer_1" x="0" y="0" version="1.1" viewBox="-0.03 59.9 512.03 392.1"><style>.st0{fill:#fd4b2d}</style><path d="M279.9 141h17.9v51.2h-17.9zm46.6-2.2h17.9v40h-17.9zM65.3 197.3c-24 0-46 13.2-57.4 34.3h30.4c13.5-11.6 33-15 47.1 0h32.2c-12.6-17.1-31.4-34.3-52.3-34.3" class="st0"/><path d="M108.7 262.4C66.8 350-6.6 275.3 38.3 231.5H7.9C-15.9 273 17 329 65.3 327.8c37.4 0 68.2-55.5 68.2-65.3 0-4.3-6-17.6-16-31H85.4c10.7 9.7 20 23.7 23.3 30.9m1.1-2.6" class="st0"/><path d="M512 140.3v231.3c0 44.3-36.1 80.4-80.4 80.4h-34.1v-78.8h-163V452h-34.1c-44.4 0-80.4-36.1-80.4-80.4v-72.8h258.4v-139H253.6V238H119.9v-97.6c0-3.1.2-6.2.5-9.2.4-3.7 1.1-7.3 2-10.8.3-1.1.6-2.3 1-3.4.1-.3.2-.6.3-.8.2-.6.4-1.1.5-1.7.2-.5.4-1.1.6-1.7s.5-1.2.7-1.8.5-1.2.8-1.8c2-4.7 4.4-9.3 7.3-13.6l.1-.1c.7-1.1 1.5-2.1 2.3-3.2.7-.9 1.3-1.7 2-2.6.8-.9 1.6-1.9 2.4-2.8s1.6-1.8 2.4-2.6l.1-.1c.4-.5.9-.9 1.4-1.4 3-2.9 6.2-5.6 9.6-8 .9-.7 1.9-1.3 2.8-1.9 1.1-.7 2.2-1.4 3.3-2 2.1-1.2 4.2-2.4 6.5-3.4.7-.3 1.4-.7 2.1-1 3.1-1.3 6.2-2.5 9.4-3.4 1.2-.4 2.5-.7 3.7-1 .6-.2 1.2-.3 1.8-.4 3.6-.8 7.2-1.3 10.9-1.6l1.6-.1h.8c1.2-.1 2.4-.1 3.7-.1h231.3c1.2 0 2.5 0 3.7.1h.8l1.6.1c3.7.3 7.3.8 10.9 1.6.6.1 1.2.3 1.8.4 1.3.3 2.5.6 3.7 1 3.2.9 6.3 2.1 9.4 3.4.7.3 1.4.6 2.1 1 2.2 1 4.4 2.2 6.5 3.4 1.1.7 2.2 1.3 3.3 2 1 .6 1.9 1.3 2.8 1.9 3.9 2.8 7.6 6 11 9.4.8.8 1.7 1.7 2.4 2.6.8.9 1.6 1.9 2.4 2.8.7.8 1.3 1.7 2 2.6.8 1.1 1.5 2.1 2.3 3.2l.1.1c2.9 4.3 5.3 8.8 7.3 13.6.2.6.5 1.2.8 1.8.2.6.5 1.2.7 1.8.2.5.4 1.1.6 1.7s.4 1.1.5 1.7c.1.3.2.6.3.8.3 1.1.7 2.3 1 3.4.9 3.6 1.6 7.2 2 10.8 0 3.1.2 6.1.2 9.2" class="st0"/><path d="M498.3 95.5H133.5c14.9-22.2 40-35.6 66.7-35.6h231.3c26.9 0 51.9 13.4 66.8 35.6m13.2 35.6H120.4c1.4-12.8 6-25 13.1-35.6h364.8c7.2 10.6 11.7 22.9 13.2 35.6m.5 9.2v26.4H378.3v-6.9H253.6v6.9H119.9v-26.4c0-3.1.2-6.2.5-9.2h391.1c.3 3.1.5 6.1.5 9.2M119.9 166.7h133.7v35.6H119.9zm258.4 0H512v35.6H378.3zm-258.4 35.6h133.7v35.6H119.9zm258.4 0H512v35.6H378.3z" class="st0"/></svg>
        "gitlab.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="93.97 97.52 192.05 184.99"><defs><style>.cls-2{fill:#fc6d26}</style></defs><g id="LOGO"><path d="m282.83 170.73-.27-.69-26.14-68.22a6.8 6.8 0 0 0-2.69-3.24 7 7 0 0 0-8 .43 7 7 0 0 0-2.32 3.52l-17.65 54h-71.47l-17.65-54a6.86 6.86 0 0 0-2.32-3.53 7 7 0 0 0-8-.43 6.87 6.87 0 0 0-2.69 3.24L97.44 170l-.26.69a48.54 48.54 0 0 0 16.1 56.1l.09.07.24.17 39.82 29.82 19.7 14.91 12 9.06a8.07 8.07 0 0 0 9.76 0l12-9.06 19.7-14.91 40.06-30 .1-.08a48.56 48.56 0 0 0 16.08-56.04" style="fill:#e24329"/><path d="m282.83 170.73-.27-.69a88.3 88.3 0 0 0-35.15 15.8L190 229.25c19.55 14.79 36.57 27.64 36.57 27.64l40.06-30 .1-.08a48.56 48.56 0 0 0 16.1-56.08" class="cls-2"/><path d="m153.43 256.89 19.7 14.91 12 9.06a8.07 8.07 0 0 0 9.76 0l12-9.06 19.7-14.91S209.55 244 190 229.25c-19.55 14.75-36.57 27.64-36.57 27.64" style="fill:#fca326"/><path d="M132.58 185.84A88.2 88.2 0 0 0 97.44 170l-.26.69a48.54 48.54 0 0 0 16.1 56.1l.09.07.24.17 39.82 29.82L190 229.21Z" class="cls-2"/></g></svg>
        "longhorn.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 356.98 294.48"><defs><style>.cls-2{fill:#5f224a}</style></defs><path d="M305.05 60.253a17.663 17.663 0 0 0-20.036 14.918l-2.606 17.715-103.788 20.721L74.832 92.886 72.226 75.17a17.663 17.663 0 0 0-34.95 5.144l4.42 30.027a17.66 17.66 0 0 0 14.016 14.75l73.128 14.6 9.964 61.31a35.37 35.37 0 0 0 35.288 33.662h9.054a35.373 35.373 0 0 0 35.278-33.46l11.245-61.556c.013-.072.016-.143.028-.215l71.831-14.341a17.66 17.66 0 0 0 14.017-14.75l4.42-30.027.003-.027a17.663 17.663 0 0 0-14.918-20.035m-121.616 135.91a17.7 17.7 0 0 0-.288 3.175h-9.054a17.5 17.5 0 0 0-.23-2.834l-8.034-49.427 9.334 1.863a17.7 17.7 0 0 0 6.916 0l10.361-2.068Z" style="fill:#fff"/><path d="M178.62 149.282a17.7 17.7 0 0 1-3.458-.342l-9.334-1.863 8.035 49.427a17.5 17.5 0 0 1 .23 2.834h9.053a17.7 17.7 0 0 1 .288-3.175l9.005-49.291-10.36 2.068a17.7 17.7 0 0 1-3.459.342" class="cls-2"/><path d="M313.862 6.87H43.379A36.423 36.423 0 0 0 7.062 43.186v208.368A36.423 36.423 0 0 0 43.38 287.87h270.483a36.423 36.423 0 0 0 36.316-36.316V43.186A36.423 36.423 0 0 0 313.862 6.87m6.106 73.418-.004.027-4.42 30.027a17.66 17.66 0 0 1-14.016 14.75l-71.831 14.341c-.012.072-.015.143-.028.215l-11.245 61.557a35.373 35.373 0 0 1-35.278 33.459h-9.054A35.37 35.37 0 0 1 138.804 201l-9.964-61.31-73.128-14.6a17.66 17.66 0 0 1-14.017-14.749l-4.42-30.027a17.663 17.663 0 0 1 34.951-5.144l2.606 17.715 103.788 20.721 103.788-20.721 2.606-17.715a17.663 17.663 0 1 1 34.954 5.117" class="cls-2"/></svg>
        "prometheus.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 512 512"><path d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256 256-114.6 256-256S397.4 0 256 0m0 479.1c-40.2 0-72.8-26.9-72.8-60h145.7c-.1 33.1-32.7 60-72.9 60m120.3-79.9H135.7v-43.6h240.6zm-.9-66h-239c-.8-.9-1.6-1.8-2.4-2.8-24.6-29.9-30.4-45.5-36.1-61.4-.1-.5 29.9 6.1 51.1 10.9 0 0 10.9 2.5 26.9 5.4-15.3-18-24.5-40.9-24.5-64.2 0-51.3 39.4-96.2 25.2-132.4 13.8 1.1 28.6 29.2 29.6 73 14.7-20.3 20.8-57.4 20.8-80.1 0-23.5 15.5-50.9 31-51.8-13.8 22.8 3.6 42.3 19.1 90.8 5.8 18.2 5.1 48.8 9.5 68.3 1.5-40.4 8.4-99.2 34-119.6-11.3 25.6 1.7 57.6 10.5 73 14.3 24.8 23 43.7 23 79.3 0 23.9-8.8 46.3-23.7 63.9 16.9-3.2 28.6-6 28.6-6l54.9-10.7c.2 0-7.8 32.8-38.5 64.4" style="fill:#e6522c"/></svg>
        "grafana.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 512 512"><linearGradient id="a" x1="256" x2="256" y1="359.964" y2="4.738" gradientTransform="matrix(1 0 0 -1 0 513)" gradientUnits="userSpaceOnUse"><stop offset="0" style="stop-color:#f05a28"/><stop offset="1" style="stop-color:#fbca0a"/></linearGradient><path d="M490.8 226c-.8-8.6-2.3-18.5-5.1-29.5-2.8-10.9-7.1-22.8-13.3-35.3-6.2-12.4-14.2-25.2-24.7-37.8-4.1-4.9-8.6-9.7-13.4-14.4 7.2-28.6-8.7-53.5-8.7-53.5-27.5-1.7-45 8.6-51.5 13.3-1.1-.4-2.1-1-3.2-1.4-4.7-1.8-9.5-3.7-14.5-5.2-4.9-1.6-10-3-15.2-4.2-5.2-1.3-10.4-2.3-15.8-3.1-1-.1-1.8-.3-2.8-.4C310.6 16.1 276.1 0 276.1 0c-38.5 24.4-45.7 58.5-45.7 58.5s-.1.7-.4 2c-2.1.6-4.2 1.3-6.3 1.8-3 .8-5.9 2-8.7 3.1-3 1.1-5.8 2.3-8.7 3.5-5.8 2.5-11.6 5.4-17.2 8.5-5.5 3.1-10.9 6.5-16.1 10l-1.4-.6C118.2 66.6 70.9 91 70.9 91c-4.4 56.7 21.3 92.4 26.4 98.9-1.3 3.5-2.4 7.1-3.5 10.6-3.9 12.8-6.9 26-8.7 39.6-.3 2-.6 3.9-.7 5.9-49.4 24.4-63.9 74.2-63.9 74.2 41 47.3 89 50.2 89 50.2l.1-.1q9.15 16.35 21 30.9c3.4 4.1 6.8 7.9 10.4 11.7-15 42.9 2.1 78.4 2.1 78.4 45.7 1.7 75.7-20 82.1-25 4.5 1.6 9.2 3 13.8 4.1 14.1 3.7 28.5 5.8 42.9 6.3 3.5.1 7.2.3 10.7.1h5.1l2.3-.1v.1c21.6 30.7 59.4 35.1 59.4 35.1 26.9-28.4 28.5-56.6 28.5-62.6v-2.5c5.6-3.9 11-8.2 16.1-12.8 10.7-9.7 20.2-20.9 28.1-32.9.7-1.1 1.4-2.3 2.1-3.4 30.5 1.7 52-18.9 52-18.9-5.1-31.7-23.1-47.3-26.9-50.2 0 0-.1-.1-.4-.3-.3-.1-.3-.3-.3-.3-.1-.1-.4-.3-.7-.4.1-2 .3-3.8.4-5.8.3-3.4.3-6.9.3-10.3v-5.3l-.1-2.1-.1-2.8c0-1-.1-1.8-.3-2.7s-.1-1.8-.3-2.7l-.3-2.7-.4-2.7c-.6-3.5-1.1-6.9-2-10.4-3.2-13.7-8.6-26.7-15.5-38.4-7.1-11.7-15.8-22-25.8-30.7-9.9-8.7-21-15.8-32.6-21-11.7-5.2-23.8-8.6-36-10.2-6.1-.8-12.1-1.1-18.2-1h-4.6l-2.3.1c-.8 0-1.7.1-2.4.1-3.1.3-6.2.7-9.2 1.3-12.1 2.3-23.6 6.6-33.6 12.7s-18.8 13.5-25.8 22c-7.1 8.5-12.6 17.9-16.4 27.6s-5.9 19.9-6.5 29.6c-.1 2.4-.1 4.9-.1 7.3v1.8l.1 2c.1 1.1.1 2.4.3 3.5.4 4.9 1.4 9.7 2.7 14.2 2.7 9.2 6.9 17.5 12.1 24.5 5.2 7.1 11.6 12.8 18.2 17.5 6.6 4.5 13.8 7.8 20.9 9.9s14.1 3 20.7 3h3.7c.5 0 .8 0 1.3-.1.7 0 1.4-.1 2.1-.1.1 0 .4 0 .6-.1l.7-.1c.4 0 .8-.1 1.3-.1.8-.1 1.6-.3 2.4-.4s1.6-.3 2.3-.6c1.6-.3 3-.8 4.4-1.3 2.8-1 5.6-2.1 8-3.4 2.5-1.3 4.8-2.8 7.1-4.2.6-.4 1.3-.8 1.8-1.4 2.3-1.8 2.7-5.2.8-7.5-1.6-2-4.4-2.5-6.6-1.3-.6.3-1.1.6-1.7.8-2 1-3.9 1.8-6.1 2.5-2.1.7-4.4 1.3-6.6 1.7-1.1.1-2.3.3-3.5.4-.6 0-1.1.1-1.8.1h-3.4c-.7 0-1.4 0-2.1-.1h-.8c-.3 0-.7 0-1-.1-.7-.1-1.3-.1-2-.3-5.2-.7-10.4-2.3-15.4-4.5-5.1-2.3-9.9-5.4-14.2-9.3s-8.2-8.6-11.1-14c-3-5.4-5.1-11.3-6.1-17.5-.4-3.1-.7-6.3-.6-9.5 0-.8.1-1.7.1-2.5v-1.1c0-.4.1-.8.1-1.3.1-1.7.4-3.4.7-5.1 2.4-13.5 9.2-26.8 19.6-36.8 2.7-2.5 5.5-4.8 8.5-6.9s6.2-3.9 9.6-5.5 6.8-2.8 10.4-3.8c3.5-1 7.2-1.6 11-2 1.8-.1 3.7-.3 5.6-.3h4.4l1.6.1c4.1.3 8 .8 12 1.8 7.9 1.7 15.7 4.7 22.8 8.6 14.4 8 26.7 20.5 34.1 35.4 3.8 7.5 6.5 15.5 7.8 23.8.3 2.1.6 4.2.7 6.3l.1 1.6.1 1.6v6.2c0 1-.1 2.7-.1 3.7-.1 2.3-.4 4.7-.7 6.9-.3 2.3-.7 4.5-1.1 6.8s-1 4.5-1.6 6.6c-1.1 4.4-2.5 8.7-4.2 13.1-3.4 8.5-7.9 16.6-13.3 24.1-10.9 15-25.7 27.1-42.6 34.8-8.5 3.8-17.3 6.6-26.5 8-4.5.8-9.2 1.3-13.8 1.4h-7c-2.5 0-4.9-.1-7.5-.4-9.9-.7-19.6-2.5-29.2-5.2-9.5-2.7-18.6-6.5-27.4-11-17.3-9.3-33-22-45.1-37.4-6.1-7.6-11.4-15.9-15.8-24.5s-7.9-17.8-10.4-26.9c-2.5-9.3-4.1-18.8-4.8-28.4l-.1-1.8v-12.2c.1-4.7.6-9.6 1.1-14.4.6-4.8 1.4-9.7 2.4-14.5s2.1-9.6 3.5-14.4c2.7-9.5 6.1-18.6 10-27.2 8-17.2 18.5-32.6 31-44.9 3.1-3.1 6.3-5.9 9.7-8.7 3.4-2.7 6.9-5.2 10.6-7.6 3.5-2.4 7.3-4.5 11.1-6.5 1.8-1 3.8-2 5.8-2.8 1-.4 2-.8 3-1.3 1-.4 2-.8 3-1.3 3.9-1.7 8-3.1 12.3-4.4 1-.3 2.1-.6 3.1-1 1-.3 2.1-.6 3.1-.8 2.1-.6 4.2-1.1 6.3-1.6 1-.3 2.1-.4 3.2-.7s2.1-.4 3.2-.7c1.1-.1 2.1-.4 3.2-.6l1.6-.3 1.7-.3c1.1-.1 2.1-.3 3.2-.4 1.3-.1 2.4-.3 3.7-.4 1-.1 2.7-.3 3.7-.4.7-.1 1.6-.1 2.3-.3l1.6-.1.7-.1h.8c1.3-.1 2.4-.1 3.7-.3l1.8-.1h1.3c1 0 2.1-.1 3.1-.1 4.1-.1 8.3-.1 12.4 0 8.2.3 16.2 1.3 24 2.7 15.7 3 30.3 7.9 43.7 14.5 13.4 6.5 25.2 14.5 35.7 23.3.7.6 1.3 1.1 2 1.7.6.6 1.3 1.1 1.8 1.7 1.3 1.1 2.4 2.3 3.7 3.4s2.4 2.3 3.5 3.4 2.3 2.3 3.4 3.5c4.4 4.7 8.5 9.3 12.1 14.1 7.3 9.5 13.3 19 17.9 28.1.3.6.6 1.1.8 1.7.3.6.6 1.1.8 1.7.6 1.1 1.1 2.3 1.6 3.4.6 1.1 1 2.1 1.6 3.2.4 1.1 1 2.1 1.4 3.2 1.7 4.2 3.4 8.3 4.7 12.1 2.1 6.2 3.7 11.7 4.9 16.5.4 2 2.3 3.2 4.2 3 2.1-.1 3.7-1.8 3.7-3.9.4-5.4.2-11.4-.5-18.3" style="fill:url(#a)"/></svg>
        "jellyfin.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 512 512"><linearGradient id="a" x1="97.508" x2="522.069" y1="308.135" y2="63.019" gradientTransform="matrix(1 0 0 -1 0 514)" gradientUnits="userSpaceOnUse"><stop offset="0" style="stop-color:#aa5cc3"/><stop offset="1" style="stop-color:#00a4dc"/></linearGradient><path d="M256 196.2c-22.4 0-94.8 131.3-83.8 153.4s156.8 21.9 167.7 0-61.3-153.4-83.9-153.4" style="fill:url(#a)"/><linearGradient id="b" x1="94.193" x2="518.754" y1="302.394" y2="57.278" gradientTransform="matrix(1 0 0 -1 0 514)" gradientUnits="userSpaceOnUse"><stop offset="0" style="stop-color:#aa5cc3"/><stop offset="1" style="stop-color:#00a4dc"/></linearGradient><path d="M256 0C188.3 0-29.8 395.4 3.4 462.2s472.3 66 505.2 0S323.8 0 256 0m165.6 404.3c-21.6 43.2-309.3 43.8-331.1 0S211.7 101.4 256 101.4 443.2 361 421.6 404.3" style="fill:url(#b)"/></svg>
        "bookstack.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" width="245.756" height="233.193" viewBox="0 0 230.397 218.62"><g fill="#fff" fill-rule="evenodd" stroke="#0288d1" stroke-linejoin="round" stroke-width="6"><g stroke-linecap="round"><path d="m98.52 180.166 128.88-74.409-92.058-53.15-128.88 74.409z"/><path d="M6.46 127.016v21.26l92.058 53.15 128.88-74.409v-21.26"/><path d="m98.52 215.596-92.058-53.15s-7.5-16.918 0-28.346l92.058 53.15 128.88-74.409v28.346z"/><path d="m98.52 130.556 128.88-74.41L135.34 3 6.46 77.406z"/><path d="M98.52 130.556 227.4 56.147v28.346L98.52 158.902l-92.058-53.15s-6.071-17.632 0-28.346z"/><path d="m98.52 187.256-92.058-53.15s-7.5-16.918 0-28.346l92.058 53.15L227.4 84.501v28.346z"/></g><path d="m156.82 15.402-55.234 31.89 21.48 1.772 3.069 12.402 55.235-31.89z"/></g></svg>
        "home-assistant.svg": |
          <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 512 512"><path d="M512 473.3c0 17.6-14.4 32-32 32H32c-17.6 0-32-14.4-32-32v-192c0-17.6 10.2-42.2 22.6-54.6L233.4 16c12.4-12.4 32.8-12.4 45.2 0l210.8 210.8c12.4 12.4 22.6 37 22.6 54.6z" style="fill:#f2f4f9"/><path d="M489.4 226.7 278.6 16c-12.4-12.4-32.8-12.4-45.2 0L22.6 226.7C10.2 239.1 0 263.7 0 281.3v192c0 17.6 14.4 32 32 32h196.8l-86.7-86.7c-4.5 1.5-9.2 2.4-14.2 2.4-24.1 0-43.7-19.6-43.7-43.7s19.6-43.7 43.7-43.7 43.7 19.6 43.7 43.7c0 5-.9 9.7-2.4 14.2l67.5 67.5V211.8c-14.5-7.1-24.5-22-24.5-39.2 0-24.1 19.6-43.7 43.7-43.7s43.7 19.6 43.7 43.7c0 17.2-10 32.1-24.5 39.2v173.4l67.1-67.1c-1.3-4.2-2-8.6-2-13.2 0-24.1 19.6-43.7 43.7-43.7s43.7 19.6 43.7 43.7-19.6 43.7-43.7 43.7c-5.3 0-10.4-1-15.1-2.8l-93.7 93.7v65.9H480c17.6 0 32-14.4 32-32v-192c0-17.6-10.2-42.2-22.6-54.7" style="fill:#18bcf2"/></svg>

- name: Deploy or upgrade Homepage
  kubernetes.core.helm:
    name: homepage
    chart_ref: jameswynn/homepage
    chart_version: "{{ homepage_version }}"
    release_namespace: homepage
    create_namespace: true
    values: "{{ lookup('template', 'values-homepage.yml.j2') | from_yaml }}"
    wait: true
    wait_timeout: 5m
  register: Homepage_deploy
  when: deploy_homepage | bool
